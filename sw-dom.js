document.addEventListener("DOMContentLoaded",(()=>{if(!navigator.serviceWorker?.controller)return;const e=e=>{const t=e.endsWith("js")?"script":"link",o="link"===t?"href":"src";for(let r of document.getElementsByTagName(t)){const n=r[o];if(e.length>n?e.endsWith(n):n.endsWith(e)){const e=document.createElement(t),o=r.text||r.textContent||r.innerHTML||"";return Array.from(r.attributes).forEach((t=>e.setAttribute(t.name,t.value))),e.appendChild(document.createTextNode(o)),r.parentNode.replaceChildren(e,r),!0}}},t="updated",{onSuccess:o}=require("../config");var r;sessionStorage.getItem(t)?(o(),sessionStorage.removeItem(t)):(r="update",navigator.serviceWorker.controller.postMessage(r)),navigator.serviceWorker.addEventListener("message",(r=>{const n=r.data;sessionStorage.setItem(t,n.type);const s=n.list?.filter((e=>/\.(js|css)$/.test(e)));if(s)window.Pjax?.isSupported?.()&&s.forEach(e),location.reload();else{const e=n.new,r=n.old;!r||e.global===r.global&&e.local===r.local||o(),sessionStorage.removeItem(t)}}))}));